<script>
    const sheetId = '1SDQaijpBd1TvVLLLSWf5HyBn8m_rB8HvFQkmPTpbzw0';
    // Sheet name က 'Sheet1' ဖြစ်ရပါမယ်
    const base = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Sheet1`;

    fetch(base)
        .then(res => res.text())
        .then(data => {
            const json = JSON.parse(data.substring(47).slice(0, -2));
            const rows = json.table.rows;
            let html = '';

            // Row 1 က ခေါင်းစဉ်ဖြစ်လို့ index 0 ကို ကျော်ပါတယ်
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i].c;
                const id = row[0] ? row[0].v : '';
                const name = row[1] ? row[1].v : '';
                const price = row[2] ? row[2].v : '';
                const status = row[3] ? row[3].v : 'Available';
                const img = row[4] ? row[4].v : '';

                const isAvailable = status.toString().toLowerCase() === 'available';

                html += `
                    <div class="product-card">
                        <span class="status-badge ${isAvailable ? 'available' : 'sold-out'}">${status}</span>
                        <img src="${img}" class="product-image" onerror="this.src='https://via.placeholder.com/400x300?text=Flower+Image'">
                        <div class="product-info">
                            <div class="product-code">CODE: ${id}</div>
                            <h3 class="product-name">${name}</h3>
                            <p class="price">${price}</p>
                            ${isAvailable 
                                ? `<a href="tel:09676962015" class="order-btn">မှာယူရန်</a>` 
                                : `<a href="#" class="order-btn disabled">ကုန်သွားပါပြီ</a>`}
                        </div>
                    </div>
                `;
            }
            document.getElementById('catalog').innerHTML = html;
        });
</script>
